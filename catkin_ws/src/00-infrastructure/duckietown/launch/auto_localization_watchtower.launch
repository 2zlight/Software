<launch>
 	<arg name="veh"/>
 	<arg name="local" default="false" doc="true for running everything you possibly can on laptop. false for everything running on vehicle."/>
 	<arg name="config" default="baseline" doc="Specify a config."/>
	<arg name="param_file_name" default="default" doc="Specify a param file. ex:megaman." />
 	<arg name="camera" default="true" doc="camera set to false means only apriltags no camera nodes are launched"/>
  <arg name="live" default="true" doc="live set to false means we don't run the actual camera (i.e. running from a log file" />
  <arg name="rect_full_ratio" default="true" doc="use full ration rectified image for apriltags detections " />

  <arg name="IP" default="192.168.1.17" doc="The IP address that the server laptop connected. The default was set in config file. See 00-infrastructure/duckietown/config/baseline/tcp_communication"/>
  <arg name="same_master" default="false" doc="If we connect all machine to the same master. (laptop)" />

  <!-- Apriltags2 -->
  <include file="$(find duckietown)/launch/apriltags2.launch">
    <arg name="veh" value="$(arg veh)"/>
 		<arg name="local" value="$(arg local)"/>
 		<arg name="config" value="$(arg config)"/>
 		<arg name="param_file_name" value="$(arg param_file_name)"/>
    <arg name="camera" value="$(arg camera)"/>
    <arg name="live" value="$(arg live)"/>
		<arg name="rect_full_ratio" value="$(arg rect_full_ratio)" />
 	</include>

  <!-- Local Localization Postprocessing node -->
  <remap from="apriltags_in" to="tag_detections" />
  <include file="$(find auto_localization)/launch/apriltags2_local_localization_node.launch">
    <arg name="veh" value="$(arg veh)"/>
        <arg name="local" value="$(arg local)"/>
        <arg name="config" value="$(arg config)"/>
        <arg name="param_file_name" value="$(arg param_file_name)"/>
  </include>

  <!-- Set the process result to server-->
  <group unless="$(arg same_master)">
    <remap from="apriltags_out" to="apriltags2_local_localization_node/apriltags_out" />
    <include file="$(find auto_localization)/launch/pub2server.launch">
      <arg name="veh" value="$(arg veh)"/>
      <arg name="config" value="$(arg config)"/>
      <arg name="param_file_name" value="$(arg param_file_name)"/>
      <arg name="IP" value="$(arg IP)"/>
    </include>
  </group>

</launch>
